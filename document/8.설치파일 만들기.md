Installer
=========

지금까지 만든것들을 설치파일로 만들것이다. 물론 매 업데이트마다 새로 설치파일을 만드는건 매우 비효율적이지만 일단 처음 배포한다고 가정하고 만들어보자.

NSIS를 이용할것이다. 아래 블로그를 참고하자.

[NSIS 사용법](https://build.tistory.com/27)

HM NIS EDIT과 NSIS를 다 설치했으면 아래 방법을 따라하자.

1.HM NIS Edit을 연다.

2.상단 메뉴의 파일 --> 스크립트 마법사를 클릭한다.

3.다음을 누른다.

4.프로그램 이름, 버전, 배포자, 웹사이트를 입력하자. 사실 이름과 버전만 잘 입력하면 된다. 이후 다음을 누른다.

5.설치 아이콘을 설정하자. .ico확장자를 가진 특수한 파일이 필요하므로 굳이 설정하지 않아도 된다. 그리고 설치파일명을 설정하자. 이건 말그대로 "설치파일"의 이름이다.

예를들어 카카오톡을 설치한다면 "설치파일명"은 카카오톡installer.exe고 "프로그램명"은 카카오톡.exe일것이다.

나머지는 건들지말고 넘어가자.

6.프로그램 기본 디렉토리와 라이센스를 선택하자. 기본 디렉토리는 수정하지 않아도 되며, 바꾸지 않을경우 C-->Program Filex (x86)에 설치되는 것으로 확인되었다. 그리고 사용자가 직접 변경하도록 하는 옵션이 있으므로 
굳이 안건드려도 된다.

라이센스는 txt파일을 입력해야하며 중요하지 않다. 이후 다음을 누른다.

7.프로그램 파일을 집어넣자. 참고로 폴더는 들어가지 않으므로 images나 기타 폴더로 이루어진 것들은 스크립트에서 직접 수정해야한다. 파일들만 잘 넣은 후 넘어가자. 초기에 입력되어있는 두개는
삭제하고 우리의 파일만 넣도록 하자. 이후 다음을 누른다.

8.마지막창이 나올때까지 계속 다음을 누른다. 건드릴것이 없다.

9.스크립트 저장을 선택한 뒤 완료하자. 컴파일은 할 필요 없다.

10.HM NIS EDIT 또는 메모장 또는 어떤 프로그램으로든 저장된 스크립트 파일을 열자.

11.아래처럼 이루어진 부분을 찾자.

    Section "MainSection" SEC01
      SetOutPath "$INSTDIR"
      SetOverwrite ifnewer
      File "BOSS_announcer_downloads\1.2\virtual.ui"
      File "BOSS_announcer_downloads\1.2\speakmodule.py"
      File "BOSS_announcer_downloads\1.2\setting.ui"
      File "BOSS_announcer_downloads\1.2\setting.json"
      File "BOSS_announcer_downloads\1.2\pa.ui"
      File "BOSS_announcer_downloads\1.2\main.ui"
      File "BOSS_announcer_downloads\1.2\getsheet.py"
      File "BOSS_announcer_downloads\1.2\classify.py"
      File "BOSS_announcer_downloads\1.2\boss-tts-key.json"
      File "BOSS_announcer_downloads\1.2\app.spec"
      File "BOSS_announcer_downloads\1.2\app.py"
      File "BOSS_announcer_downloads\1.2\app.exe"
      File /r "BOSS_announcer_downloads\1.2\images\*"
      File /r "BOSS_announcer_downloads\1.2\__pycache__\*"


12. 이 부분을 똑같이 설정한다.

        Section "MainSection" SEC01
        SetOutPath "$INSTDIR"
        SetOverwrite ifnewer

13.폴더를 추가하자. 폴더는 /r을 붙이면 된다.

      File "BOSS_announcer_downloads\1.2\app.py"
      File "BOSS_announcer_downloads\1.2\app.exe"
      File /r "BOSS_announcer_downloads\1.2\images\*"
      File /r "BOSS_announcer_downloads\1.2\__pycache__\*"

14.추가 후 저장하자.

15.NSIS를 열자.

16.Compiler부분의 Compile NSI scripts를 클릭하자.

17.스크립트를 열자.

18.뭔가 글자들이 뜨며 배경이 초록으로 바뀌면 자동으로 installer가 만들어진것이다. test를 클릭하면 바로 설치할 수 있고, 테스트하기 싫다면 그냥 X를눌러 창을 끄면된다.

19.완성된 installer파일을 소중히 보관하자.

